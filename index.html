<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>M-Coin City: Space Era</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --m-red: #e31b23; --m-green: #00a650; --m-blue: #008dce; --m-gold: #f9a825; --m-dark: #1a1a1a; }
        body { font-family: 'Arial Black', sans-serif; background: #0b0d17; margin: 0; padding: 0; user-select: none; overflow: hidden; height: 100vh; color: white; }

        /* Uzay TemalÄ± Panel */
        .top-status { background: rgba(0,0,0,0.8); padding: 5px 15px; display: flex; justify-content: space-between; font-size: 10px; border-bottom: 2px solid var(--m-blue); }
        .header { background: var(--m-red); padding: 12px; display: flex; justify-content: space-between; border-bottom: 5px solid #000; box-shadow: 0 0 20px rgba(0,141,206,0.3); }

        /* Finansal Merkez */
        .bank-vault { background: white; border: 4px solid #333; margin: 10px auto; width: 85%; border-radius: 15px; padding: 12px; text-align: center; color: #333; box-shadow: 6px 6px 0px var(--m-blue); }
        .total-coins { font-size: 34px; color: var(--m-green); font-weight: bold; }
        .inflation-info { font-size: 11px; color: #666; font-weight: bold; }

        /* Galaktik Åehir */
        .space-city { width: 180px; height: 180px; background: rgba(255,255,255,0.1); border: 6px solid var(--m-blue); margin: 15px auto; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; box-shadow: 0 0 30px var(--m-blue); }
        .space-city:active { transform: scale(0.95); box-shadow: 0 0 50px var(--m-gold); }
        #city-core-img { width: 120px; filter: drop-shadow(0 0 10px white); }

        /* Enerji ve Roket YakÄ±tÄ± */
        .progress-section { padding: 0 20px; }
        .label-text { font-size: 10px; font-weight: bold; display: block; margin: 3px 0; color: var(--m-gold); }
        .bar-outer { width: 100%; height: 14px; background: #333; border-radius: 7px; border: 2px solid var(--m-blue); overflow: hidden; margin-bottom: 8px; }
        #energy-fill { width: 100%; height: 100%; background: var(--m-gold); }
        #rocket-fill { width: 0%; height: 100%; background: var(--m-red); transition: width 0.5s; }

        /* Galaktik MenÃ¼ */
        .galactic-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 10px 15px; }
        .g-btn { background: #fff; color: #333; border: 3px solid #000; padding: 10px; border-radius: 12px; font-size: 9px; font-weight: bold; text-align: center; cursor: pointer; box-shadow: 3px 3px 0 var(--m-blue); }
        .g-btn.space { background: #e3f2fd; color: var(--m-blue); }

        /* Maya Uzay Brifingi */
        .maya-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .maya-modal.active { display: flex; }
        .maya-avatar { width: 160px; border: 5px solid var(--m-blue); border-radius: 50%; box-shadow: 0 0 20px var(--m-blue); }
        .speech-bubble { background: white; color: #333; border: 4px solid #000; padding: 20px; border-radius: 20px; width: 80%; font-weight: bold; margin: 15px 0; text-align: center; }
        .btn-confirm { background: var(--m-blue); color: white; border: 3px solid #000; padding: 12px 40px; border-radius: 10px; font-weight: bold; cursor: pointer; }

        .coin-pop { position: absolute; color: var(--m-gold); font-weight: bold; animation: flyUp 0.6s forwards; pointer-events: none; }
        @keyframes flyUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }
    </style>
</head>
<body>

<div class="top-status">
    <span>ğŸ›°ï¸ YÃ–RÃœNGE DURUMU: STABÄ°L</span>
    <span id="multiplier-tag">Ã‡ARPAN: x1.0</span>
</div>

<div class="header">
    <div id="rank">ğŸš€ GALAKTÄ°K LÄ°DER</div>
    <div id="lv">Lv. 1</div>
</div>

<div class="bank-vault">
    <div class="total-coins">ğŸª™ <span id="coin-txt">0</span></div>
    <div class="inflation-info">M-COIN DEÄERÄ°: <span id="value-txt">1.00</span> USD</div>
</div>

<div class="space-city" onclick="handleTap(event)">
    <img id="city-core-img" src="https://cdn-icons-png.flaticon.com/512/619/619153.png">
</div>

<div class="progress-section">
    <span class="label-text">âš¡ ENERJÄ° REZERVÄ°: <span id="en-num">1000</span></span>
    <div class="bar-outer"><div id="energy-fill"></div></div>
    <span class="label-text">ğŸš€ ROKET YAKITI (AY GÃ–REVÄ°)</span>
    <div class="bar-outer"><div id="rocket-fill"></div></div>
</div>

<div class="galactic-grid">
    <div class="g-btn space" onclick="launchRocket()">ğŸš€ ROKETÄ° FIRLAT<br>(-2000 ğŸª™)</div>
    <div class="g-btn" onclick="centralBank()">ğŸ›ï¸ MERKEZ BANKASI<br>(Enflasyonu DÃ¼ÅŸÃ¼r)</div>
    <div class="g-btn" onclick="openMaya('Uzay madenciliÄŸi Lv. 15\'te aÃ§Ä±lacak!')">â›ï¸ MADENCÄ°LÄ°K</div>
    <div class="g-btn" onclick="claimDaily()">ğŸ GÃœNLÃœK YAKIT</div>
</div>

<div id="maya-modal" class="maya-modal">
    <img src="assets/maya.png" class="maya-avatar" onerror="this.src='https://i.ibb.co/v4S8W5p/maya-cartoon.png'">
    <div id="maya-msg" class="speech-bubble">HoÅŸ geldiniz BaÅŸkanÄ±m!</div>
    <button class="btn-confirm" onclick="closeMaya()">ANLAÅILDI</button>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    let state = JSON.parse(localStorage.getItem('mcity_space_v1')) || {
        coins: 0, pps: 5, energy: 1000, lv: 1, xp: 0, nextXp: 1000, rocket: 0, multiplier: 1.0, value: 1.00, lastDaily: 0
    };

    function update() {
        document.getElementById('coin-txt').innerText = Math.floor(state.coins).toLocaleString();
        document.getElementById('value-txt').innerText = state.value.toFixed(2);
        document.getElementById('multiplier-tag').innerText = "Ã‡ARPAN: x" + state.multiplier.toFixed(1);
        document.getElementById('en-num').innerText = Math.floor(state.energy);
        document.getElementById('energy-fill').style.width = (state.energy / 10) + "%";
        document.getElementById('rocket-fill').style.width = state.rocket + "%";
        document.getElementById('lv').innerText = "Lv. " + state.lv;
        
        // Åehir GÃ¶rseli GeliÅŸimi
        const img = document.getElementById('city-core-img');
        if(state.lv >= 5) img.src = "https://cdn-icons-png.flaticon.com/512/2099/2099143.png";
        if(state.lv >= 10) img.src = "https://cdn-icons-png.flaticon.com/512/2534/2534005.png"; // Uzay ÃœssÃ¼

        localStorage.setItem('mcity_space_v1', JSON.stringify(state));
    }

    function handleTap(e) {
        if (state.energy >= 1) {
            let gain = (1 + Math.floor(state.lv / 2)) * state.multiplier * state.value;
            state.coins += gain;
            state.energy -= 1;
            state.xp += 15;
            state.rocket = Math.min(100, state.rocket + 0.1);
            if (state.xp >= state.nextXp) levelUp();
            showCoin(e.clientX, e.clientY, "+" + gain.toFixed(1));
            update();
            tg.HapticFeedback.impactOccurred('medium');
        } else {
            openMaya("BaÅŸkanÄ±m enerji bitti. Uzay istasyonu ÅŸarj oluyor!");
        }
    }

    function levelUp() {
        state.lv++; state.xp = 0; state.nextXp *= 2.5; state.energy = 1000;
        openMaya("MUHTEÅEM! Åehrimiz artÄ±k gezegenler arasÄ± bir gÃ¼Ã§.");
    }

    function launchRocket() {
        if(state.coins < 2000) return openMaya("FÄ±rlatma iÃ§in 2000 M-Coin lazÄ±m baÅŸkanÄ±m!");
        if(state.rocket < 100) return openMaya("YakÄ±t henÃ¼z %100 deÄŸil!");
        
        state.coins -= 2000;
        state.rocket = 0;
        state.multiplier += 0.5;
        state.value += 0.50;
        openMaya("ROKET FIRLATILDI! M-Coin deÄŸer kazandÄ± ve kÃ¼resel Ã§arpanÄ±nÄ±z arttÄ±!");
        update();
    }

    function centralBank() {
        if(state.coins < 500) return openMaya("Para politikasÄ±nÄ± yÃ¶netmek iÃ§in 500 M-Coin lazÄ±m.");
        state.coins -= 500;
        state.value += 0.10;
        openMaya("Merkez BankasÄ± mÃ¼dahale etti: Enflasyon dÃ¼ÅŸtÃ¼, coin deÄŸer kazandÄ±!");
        update();
    }

    function claimDaily() {
        let now = Date.now();
        if(now - state.lastDaily > 86400000) {
            state.rocket = Math.min(100, state.rocket + 25);
            state.lastDaily = now;
            openMaya("GÃ¼nlÃ¼k yakÄ±t ikmali yapÄ±ldÄ±: +%25 Roket YakÄ±tÄ±!");
            update();
        } else { openMaya("Yeni yakÄ±t yarÄ±n gelecek baÅŸkanÄ±m."); }
    }

    function openMaya(m) {
        document.getElementById('maya-msg').innerText = m;
        document.getElementById('maya-modal').classList.add('active');
    }
    function closeMaya() { document.getElementById('maya-modal').classList.remove('active'); }

    function showCoin(x, y, t) {
        const div = document.createElement('div');
        div.className = 'coin-pop';
        div.style.left = x + 'px'; div.style.top = y + 'px';
        div.innerText = t;
        document.body.appendChild(div);
        setTimeout(() => div.remove(), 600);
    }

    setInterval(() => {
        state.coins += (state.pps * state.multiplier * state.value / 10);
        if (state.energy < 1000) state.energy += 1;
        // Zamanla deÄŸer hafifÃ§e dÃ¼ÅŸer (Enflasyon simÃ¼lasyonu)
        if (state.value > 0.5) state.value -= 0.001;
        update();
    }, 100);

    window.onload = update;
</script>
</body>
</html>
